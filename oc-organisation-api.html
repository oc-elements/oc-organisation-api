<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-ajax/iron-ajax.html">
<link rel="import" href="../oc-core-utils/oc-api-provider-behaviour.html">

<dom-module id="oc-organisation-api">
  <template>
    <iron-ajax id="createOrganisation"></iron-ajax>
    <iron-ajax id="getOrganisation"></iron-ajax>
    <iron-ajax id="getOrganisationTypes"></iron-ajax>
    <iron-ajax id="getOrganisationIndustries"></iron-ajax>
    <iron-ajax id="updateOrganisationDetails"></iron-ajax>
    <iron-ajax id="updateOrganisationTypesIndustries"></iron-ajax>
    <iron-ajax id="getOrganisationAccessToken"></iron-ajax>
    <iron-ajax id="getOrganisationHours"></iron-ajax>
    <iron-ajax id="updateOrganisationHours"></iron-ajax>
    <iron-ajax id="getBankAccountDetails"></iron-ajax>
    <iron-ajax id="updateBankAccountDetails"></iron-ajax>

  </template>

  <script>(function(){
    Polymer({
      is: 'oc-organisation-api',
      behaviors: [OC.Behaviours.ApiProvider],

      /**
       * Create a new organisation
       *
       * @return {Promise}
       */
      createOrganisation: function(newOrganisation) {
        this.$.createOrganisation.url = this._url('organisations');
        this.$.createOrganisation.method = "POST";
        this.$.createOrganisation.contentType = "application/json";
        this.$.createOrganisation.body = newOrganisation;
        return this._generateRequest(this.$.createOrganisation);
      },

      /**
       * Retrieve an organisation
       *
       * @param {Long} organisationId
       * @return {Promise}
       */
      getOrganisation: function(organisationId) {
        this.$.getOrganisation.url = this._url('organisations/' + organisationId);
        return this._generateRequest(this.$.getOrganisation);
      },

      /**
       * Retrieve all Ordercloud supported organisation types
       *
       * @return {Promise}
       */
      getOrganisationTypes: function() {
        this.$.getOrganisationTypes.url = this._url('organisations/types');
        return this._generateRequest(this.$.getOrganisationTypes);
      },

      /**
       * Retrieve all Ordercloud supported industries
       *
       * @return {Promise}
       */
      getOrganisationIndustries: function() {
        this.$.getOrganisationIndustries.url = this._url('industry');
        return this._generateRequest(this.$.getOrganisationIndustries);
      },

      /**
       * Update an organisation's details
       *
       * @return {Promise}
       */
      updateOrganisationDetails: function(organisationId, organisationDetails) {
        this.$.updateOrganisationDetails.url = this._url('organisations/' + organisationId + '/detail');
        this.$.updateOrganisationDetails.method = "PUT";
        this.$.updateOrganisationDetails.contentType = "application/json";
        this.$.updateOrganisationDetails.body = organisationDetails;
        return this._generateRequest(this.$.updateOrganisationDetails);
      },

      /**
       * Update an organisation's declared types and industries
       *
       * @return {Promise}
       */
      updateOrganisationTypesIndustries: function(organisationId, selectedTypesAndIndustries) {
        this.$.updateOrganisationTypesIndustries.url = this._url('organisations/' + organisationId + '/setup/typeindustry');
        this.$.updateOrganisationTypesIndustries.method = "PUT";
        this.$.updateOrganisationTypesIndustries.contentType = "application/json";
        this.$.updateOrganisationTypesIndustries.body = selectedTypesAndIndustries;
        return this._generateRequest(this.$.updateOrganisationTypesIndustries);
      },

      /**
       * Get the access token for an organisation.
       * @param {Number} organisationId
       * @returns {Promise}
       */
      getOrganisationAccessToken: function(organisationId) {
        this.$.getOrganisationAccessToken.url = this._url('organisations/' + organisationId + '/accesstoken');
        return this._generateRequest(this.$.getOrganisationAccessToken);
      },

      /**
       * Get an organisation's business hours
       *
       * @return {Promise}
       */
      getOrganisationHours: function(organisationId) {
        this.$.getOrganisationHours.url = this._url('organisations/' + organisationId + '/hours');
        return this._generateRequest(this.$.getOrganisationHours);
      },

      /**
       * Update an organisation's business hours
       *
       * @return {Promise}
       */
      updateOrganisationHours: function(organisationId, businessHours) {
        this.$.updateOrganisationHours.url = this._url('organisations/' + organisationId + '/hours');
        this.$.updateOrganisationHours.method = "PUT";
        this.$.updateOrganisationHours.contentType = "application/json";
        this.$.updateOrganisationHours.body = businessHours;
        return this._generateRequest(this.$.updateOrganisationHours);
      },

      /**
       * Get an organisation's bank account details
       *
       * @return {Promise}
       */
      getBankAccountDetails: function(organisationId) {
        this.$.getBankAccountDetails.url = this._url('organisations/' + organisationId + '/bankdetail');
        return this._generateRequest(this.$.getBankAccountDetails);
      },

      /**
       * Update an organisation's bank account details
       *
       * @return {Promise}
       */
      updateBankAccountDetails: function(organisationId, accountDetails) {
        this.$.updateBankAccountDetails.url = this._url('organisations/' + organisationId + '/bankdetail');
        this.$.updateBankAccountDetails.method = "PUT";
        this.$.updateBankAccountDetails.contentType = "application/json";
        this.$.updateBankAccountDetails.body = accountDetails;
        return this._generateRequest(this.$.updateBankAccountDetails);
      },
    });
  })();
  </script>
</dom-module>
